cdp_market_views_abi = """[{"stateMutability":"nonpayable","type":"constructor","inputs":[{"name":"controller","type":"address"}],"outputs":[]},{"stateMutability":"view","type":"function","name":"get_market_states","inputs":[{"name":"markets","type":"address[]"}],"outputs":[{"name":"","type":"tuple[]","components":[{"name":"total_debt","type":"uint256"},{"name":"total_coll","type":"uint256"},{"name":"debt_ceiling","type":"uint256"},{"name":"remaining_mintable","type":"uint256"},{"name":"oracle_price","type":"uint256"},{"name":"current_rate","type":"uint256"},{"name":"pending_rate","type":"uint256"}]}]},{"stateMutability":"view","type":"function","name":"get_market_amm_bands","inputs":[{"name":"market","type":"address"}],"outputs":[{"name":"","type":"tuple[]","components":[{"name":"band_num","type":"int256"},{"name":"price_range","type":"uint256[2]"},{"name":"coll_balance","type":"uint256"},{"name":"debt_balance","type":"uint256"}]},{"name":"","type":"int256[2]"}]},{"stateMutability":"view","type":"function","name":"get_market_amm_bands","inputs":[{"name":"market","type":"address"},{"name":"lower_band","type":"int256"}],"outputs":[{"name":"","type":"tuple[]","components":[{"name":"band_num","type":"int256"},{"name":"price_range","type":"uint256[2]"},{"name":"coll_balance","type":"uint256"},{"name":"debt_balance","type":"uint256"}]},{"name":"","type":"int256[2]"}]},{"stateMutability":"view","type":"function","name":"get_market_amm_bands","inputs":[{"name":"market","type":"address"},{"name":"lower_band","type":"int256"},{"name":"num_bands","type":"uint256"}],"outputs":[{"name":"","type":"tuple[]","components":[{"name":"band_num","type":"int256"},{"name":"price_range","type":"uint256[2]"},{"name":"coll_balance","type":"uint256"},{"name":"debt_balance","type":"uint256"}]},{"name":"","type":"int256[2]"}]},{"stateMutability":"view","type":"function","name":"get_market_states_for_account","inputs":[{"name":"account","type":"address"},{"name":"markets","type":"address[]"}],"outputs":[{"name":"","type":"tuple[]","components":[{"name":"market","type":"address"},{"name":"account_debt","type":"uint256"},{"name":"amm_coll_balance","type":"uint256"},{"name":"amm_stable_balance","type":"uint256"},{"name":"health","type":"int256"},{"name":"bands","type":"int256[2]"},{"name":"coll_conversion_range","type":"uint256[2]"}]}]},{"stateMutability":"view","type":"function","name":"get_pending_market_state_for_account","inputs":[{"name":"account","type":"address"},{"name":"market","type":"address"},{"name":"coll_change","type":"int256"},{"name":"debt_change","type":"int256"}],"outputs":[{"name":"","type":"tuple","components":[{"name":"account_debt","type":"uint256"},{"name":"amm_coll_balance","type":"uint256"},{"name":"amm_stable_balance","type":"uint256"},{"name":"health","type":"int256"},{"name":"bands","type":"int256[2]"},{"name":"coll_conversion_range","type":"uint256[2]"},{"name":"hook_debt_adjustment","type":"int256"}]}]},{"stateMutability":"view","type":"function","name":"get_pending_market_state_for_account","inputs":[{"name":"account","type":"address"},{"name":"market","type":"address"},{"name":"coll_change","type":"int256"},{"name":"debt_change","type":"int256"},{"name":"num_bands","type":"uint256"}],"outputs":[{"name":"","type":"tuple","components":[{"name":"account_debt","type":"uint256"},{"name":"amm_coll_balance","type":"uint256"},{"name":"amm_stable_balance","type":"uint256"},{"name":"health","type":"int256"},{"name":"bands","type":"int256[2]"},{"name":"coll_conversion_range","type":"uint256[2]"},{"name":"hook_debt_adjustment","type":"int256"}]}]},{"stateMutability":"view","type":"function","name":"get_close_loan_amounts","inputs":[{"name":"account","type":"address"},{"name":"market","type":"address"}],"outputs":[{"name":"","type":"tuple","components":[{"name":"total_debt_repaid","type":"uint256"},{"name":"debt_burned","type":"uint256"},{"name":"debt_from_amm","type":"uint256"},{"name":"coll_withdrawn","type":"uint256"},{"name":"hook_debt_adjustment","type":"int256"}]}]},{"stateMutability":"view","type":"function","name":"get_liquidation_amounts","inputs":[{"name":"caller","type":"address"},{"name":"market","type":"address"}],"outputs":[{"name":"","type":"tuple[]","components":[{"name":"account","type":"address"},{"name":"total_debt_repaid","type":"uint256"},{"name":"debt_burned","type":"uint256"},{"name":"debt_from_amm","type":"uint256"},{"name":"coll_received","type":"uint256"},{"name":"hook_debt_adjustment","type":"int256"}]}]},{"stateMutability":"view","type":"function","name":"get_liquidation_amounts","inputs":[{"name":"caller","type":"address"},{"name":"market","type":"address"},{"name":"start","type":"uint256"}],"outputs":[{"name":"","type":"tuple[]","components":[{"name":"account","type":"address"},{"name":"total_debt_repaid","type":"uint256"},{"name":"debt_burned","type":"uint256"},{"name":"debt_from_amm","type":"uint256"},{"name":"coll_received","type":"uint256"},{"name":"hook_debt_adjustment","type":"int256"}]}]},{"stateMutability":"view","type":"function","name":"get_liquidation_amounts","inputs":[{"name":"caller","type":"address"},{"name":"market","type":"address"},{"name":"start","type":"uint256"},{"name":"limit","type":"uint256"}],"outputs":[{"name":"","type":"tuple[]","components":[{"name":"account","type":"address"},{"name":"total_debt_repaid","type":"uint256"},{"name":"debt_burned","type":"uint256"},{"name":"debt_from_amm","type":"uint256"},{"name":"coll_received","type":"uint256"},{"name":"hook_debt_adjustment","type":"int256"}]}]},{"stateMutability":"view","type":"function","name":"get_max_borrowable","inputs":[{"name":"market","type":"address"},{"name":"coll_amount","type":"uint256"},{"name":"n_bands","type":"uint256"}],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"get_min_collateral","inputs":[{"name":"market","type":"address"},{"name":"debt_amount","type":"uint256"},{"name":"n_bands","type":"uint256"}],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"MAIN_CONTROLLER","inputs":[],"outputs":[{"name":"","type":"address"}]}]"""
amm_abi = """[{"name":"TokenExchange","inputs":[{"name":"buyer","type":"address","indexed":true},{"name":"sold_id","type":"uint256","indexed":false},{"name":"tokens_sold","type":"uint256","indexed":false},{"name":"bought_id","type":"uint256","indexed":false},{"name":"tokens_bought","type":"uint256","indexed":false}],"anonymous":false,"type":"event"},{"name":"Deposit","inputs":[{"name":"provider","type":"address","indexed":true},{"name":"amount","type":"uint256","indexed":false},{"name":"n1","type":"int256","indexed":false},{"name":"n2","type":"int256","indexed":false}],"anonymous":false,"type":"event"},{"name":"Withdraw","inputs":[{"name":"provider","type":"address","indexed":true},{"name":"amount_borrowed","type":"uint256","indexed":false},{"name":"amount_collateral","type":"uint256","indexed":false}],"anonymous":false,"type":"event"},{"name":"SetRate","inputs":[{"name":"rate","type":"uint256","indexed":false},{"name":"rate_mul","type":"uint256","indexed":false},{"name":"time","type":"uint256","indexed":false}],"anonymous":false,"type":"event"},{"stateMutability":"nonpayable","type":"constructor","inputs":[{"name":"controller","type":"address"},{"name":"stablecoin","type":"address"},{"name":"_A","type":"uint256"}],"outputs":[]},{"stateMutability":"nonpayable","type":"function","name":"initialize","inputs":[{"name":"market","type":"address"},{"name":"oracle","type":"address"},{"name":"collateral","type":"address"},{"name":"base_price","type":"uint256"},{"name":"fee","type":"uint256"},{"name":"admin_fee","type":"uint256"}],"outputs":[]},{"stateMutability":"view","type":"function","name":"coins","inputs":[{"name":"i","type":"uint256"}],"outputs":[{"name":"","type":"address"}]},{"stateMutability":"view","type":"function","name":"price_oracle","inputs":[],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"dynamic_fee","inputs":[],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"get_rate_mul","inputs":[],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"get_base_price","inputs":[],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"p_current_up","inputs":[{"name":"n","type":"int256"}],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"p_current_down","inputs":[{"name":"n","type":"int256"}],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"p_oracle_up","inputs":[{"name":"n","type":"int256"}],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"p_oracle_down","inputs":[{"name":"n","type":"int256"}],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"get_p","inputs":[],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"read_user_tick_numbers","inputs":[{"name":"user","type":"address"}],"outputs":[{"name":"","type":"int256[2]"}]},{"stateMutability":"view","type":"function","name":"can_skip_bands","inputs":[{"name":"n_end","type":"int256"}],"outputs":[{"name":"","type":"bool"}]},{"stateMutability":"view","type":"function","name":"active_band_with_skip","inputs":[],"outputs":[{"name":"","type":"int256"}]},{"stateMutability":"view","type":"function","name":"has_liquidity","inputs":[{"name":"user","type":"address"}],"outputs":[{"name":"","type":"bool"}]},{"stateMutability":"view","type":"function","name":"get_dy","inputs":[{"name":"i","type":"uint256"},{"name":"j","type":"uint256"},{"name":"in_amount","type":"uint256"}],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"get_dxdy","inputs":[{"name":"i","type":"uint256"},{"name":"j","type":"uint256"},{"name":"in_amount","type":"uint256"}],"outputs":[{"name":"","type":"uint256"},{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"get_dx","inputs":[{"name":"i","type":"uint256"},{"name":"j","type":"uint256"},{"name":"out_amount","type":"uint256"}],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"get_dydx","inputs":[{"name":"i","type":"uint256"},{"name":"j","type":"uint256"},{"name":"out_amount","type":"uint256"}],"outputs":[{"name":"","type":"uint256"},{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"get_y_up","inputs":[{"name":"user","type":"address"}],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"get_x_down","inputs":[{"name":"user","type":"address"}],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"get_sum_xy","inputs":[{"name":"user","type":"address"}],"outputs":[{"name":"","type":"uint256[2]"}]},{"stateMutability":"view","type":"function","name":"get_xy","inputs":[{"name":"user","type":"address"}],"outputs":[{"name":"","type":"uint256[][2]"}]},{"stateMutability":"view","type":"function","name":"get_amount_for_price","inputs":[{"name":"p","type":"uint256"}],"outputs":[{"name":"","type":"uint256"},{"name":"","type":"bool"}]},{"stateMutability":"nonpayable","type":"function","name":"price_oracle_w","inputs":[],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"nonpayable","type":"function","name":"exchange","inputs":[{"name":"i","type":"uint256"},{"name":"j","type":"uint256"},{"name":"in_amount","type":"uint256"},{"name":"min_amount","type":"uint256"}],"outputs":[{"name":"","type":"uint256[2]"}]},{"stateMutability":"nonpayable","type":"function","name":"exchange","inputs":[{"name":"i","type":"uint256"},{"name":"j","type":"uint256"},{"name":"in_amount","type":"uint256"},{"name":"min_amount","type":"uint256"},{"name":"_for","type":"address"}],"outputs":[{"name":"","type":"uint256[2]"}]},{"stateMutability":"nonpayable","type":"function","name":"exchange_dy","inputs":[{"name":"i","type":"uint256"},{"name":"j","type":"uint256"},{"name":"out_amount","type":"uint256"},{"name":"max_amount","type":"uint256"}],"outputs":[{"name":"","type":"uint256[2]"}]},{"stateMutability":"nonpayable","type":"function","name":"exchange_dy","inputs":[{"name":"i","type":"uint256"},{"name":"j","type":"uint256"},{"name":"out_amount","type":"uint256"},{"name":"max_amount","type":"uint256"},{"name":"_for","type":"address"}],"outputs":[{"name":"","type":"uint256[2]"}]},{"stateMutability":"nonpayable","type":"function","name":"deposit_range","inputs":[{"name":"user","type":"address"},{"name":"amount","type":"uint256"},{"name":"n1","type":"int256"},{"name":"n2","type":"int256"}],"outputs":[]},{"stateMutability":"nonpayable","type":"function","name":"withdraw","inputs":[{"name":"user","type":"address"},{"name":"frac","type":"uint256"}],"outputs":[{"name":"","type":"uint256[2]"}]},{"stateMutability":"nonpayable","type":"function","name":"set_fee","inputs":[{"name":"fee","type":"uint256"}],"outputs":[]},{"stateMutability":"nonpayable","type":"function","name":"set_admin_fee","inputs":[{"name":"fee","type":"uint256"}],"outputs":[]},{"stateMutability":"nonpayable","type":"function","name":"reset_admin_fees","inputs":[],"outputs":[{"name":"","type":"uint256[2]"}]},{"stateMutability":"nonpayable","type":"function","name":"set_liquidity_mining_hook","inputs":[{"name":"lm_hook","type":"address"}],"outputs":[]},{"stateMutability":"nonpayable","type":"function","name":"set_oracle","inputs":[{"name":"oracle","type":"address"}],"outputs":[]},{"stateMutability":"nonpayable","type":"function","name":"set_rate","inputs":[{"name":"rate","type":"uint256"}],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"MARKET_OPERATOR","inputs":[],"outputs":[{"name":"","type":"address"}]},{"stateMutability":"view","type":"function","name":"ORACLE","inputs":[],"outputs":[{"name":"","type":"address"}]},{"stateMutability":"view","type":"function","name":"A","inputs":[],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"fee","inputs":[],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"admin_fee","inputs":[],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"rate","inputs":[],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"active_band","inputs":[],"outputs":[{"name":"","type":"int256"}]},{"stateMutability":"view","type":"function","name":"min_band","inputs":[],"outputs":[{"name":"","type":"int256"}]},{"stateMutability":"view","type":"function","name":"max_band","inputs":[],"outputs":[{"name":"","type":"int256"}]},{"stateMutability":"view","type":"function","name":"bands_x","inputs":[{"name":"arg0","type":"int256"}],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"bands_y","inputs":[{"name":"arg0","type":"int256"}],"outputs":[{"name":"","type":"uint256"}]},{"stateMutability":"view","type":"function","name":"lm_hook","inputs":[],"outputs":[{"name":"","type":"address"}]}]"""
multicall_abi = """[{"inputs":[{"components":[{"internalType":"address","name":"target","type":"address"},{"internalType":"bytes","name":"callData","type":"bytes"}],"internalType":"struct Multicall3.Call[]","name":"calls","type":"tuple[]"}],"name":"aggregate","outputs":[{"internalType":"uint256","name":"blockNumber","type":"uint256"},{"internalType":"bytes[]","name":"returnData","type":"bytes[]"}],"stateMutability":"payable","type":"function"},{"inputs":[{"components":[{"internalType":"address","name":"target","type":"address"},{"internalType":"bool","name":"allowFailure","type":"bool"},{"internalType":"bytes","name":"callData","type":"bytes"}],"internalType":"struct Multicall3.Call3[]","name":"calls","type":"tuple[]"}],"name":"aggregate3","outputs":[{"components":[{"internalType":"bool","name":"success","type":"bool"},{"internalType":"bytes","name":"returnData","type":"bytes"}],"internalType":"struct Multicall3.Result[]","name":"returnData","type":"tuple[]"}],"stateMutability":"payable","type":"function"},{"inputs":[{"components":[{"internalType":"address","name":"target","type":"address"},{"internalType":"bool","name":"allowFailure","type":"bool"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"callData","type":"bytes"}],"internalType":"struct Multicall3.Call3Value[]","name":"calls","type":"tuple[]"}],"name":"aggregate3Value","outputs":[{"components":[{"internalType":"bool","name":"success","type":"bool"},{"internalType":"bytes","name":"returnData","type":"bytes"}],"internalType":"struct Multicall3.Result[]","name":"returnData","type":"tuple[]"}],"stateMutability":"payable","type":"function"},{"inputs":[{"components":[{"internalType":"address","name":"target","type":"address"},{"internalType":"bytes","name":"callData","type":"bytes"}],"internalType":"struct Multicall3.Call[]","name":"calls","type":"tuple[]"}],"name":"blockAndAggregate","outputs":[{"internalType":"uint256","name":"blockNumber","type":"uint256"},{"internalType":"bytes32","name":"blockHash","type":"bytes32"},{"components":[{"internalType":"bool","name":"success","type":"bool"},{"internalType":"bytes","name":"returnData","type":"bytes"}],"internalType":"struct Multicall3.Result[]","name":"returnData","type":"tuple[]"}],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"getBasefee","outputs":[{"internalType":"uint256","name":"basefee","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"blockNumber","type":"uint256"}],"name":"getBlockHash","outputs":[{"internalType":"bytes32","name":"blockHash","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getBlockNumber","outputs":[{"internalType":"uint256","name":"blockNumber","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getChainId","outputs":[{"internalType":"uint256","name":"chainid","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getCurrentBlockCoinbase","outputs":[{"internalType":"address","name":"coinbase","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getCurrentBlockDifficulty","outputs":[{"internalType":"uint256","name":"difficulty","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getCurrentBlockGasLimit","outputs":[{"internalType":"uint256","name":"gaslimit","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getCurrentBlockTimestamp","outputs":[{"internalType":"uint256","name":"timestamp","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"addr","type":"address"}],"name":"getEthBalance","outputs":[{"internalType":"uint256","name":"balance","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getLastBlockHash","outputs":[{"internalType":"bytes32","name":"blockHash","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bool","name":"requireSuccess","type":"bool"},{"components":[{"internalType":"address","name":"target","type":"address"},{"internalType":"bytes","name":"callData","type":"bytes"}],"internalType":"struct Multicall3.Call[]","name":"calls","type":"tuple[]"}],"name":"tryAggregate","outputs":[{"components":[{"internalType":"bool","name":"success","type":"bool"},{"internalType":"bytes","name":"returnData","type":"bytes"}],"internalType":"struct Multicall3.Result[]","name":"returnData","type":"tuple[]"}],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"bool","name":"requireSuccess","type":"bool"},{"components":[{"internalType":"address","name":"target","type":"address"},{"internalType":"bytes","name":"callData","type":"bytes"}],"internalType":"struct Multicall3.Call[]","name":"calls","type":"tuple[]"}],"name":"tryBlockAndAggregate","outputs":[{"internalType":"uint256","name":"blockNumber","type":"uint256"},{"internalType":"bytes32","name":"blockHash","type":"bytes32"},{"components":[{"internalType":"bool","name":"success","type":"bool"},{"internalType":"bytes","name":"returnData","type":"bytes"}],"internalType":"struct Multicall3.Result[]","name":"returnData","type":"tuple[]"}],"stateMutability":"payable","type":"function"}]"""